<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Document</title>
  <style>
    :root {
      --bg1: #ffe4ec;
      --bg2: #ffd1e0;
      --h1: #ff6b9a;
      --h2: #ffadc4;
      --h3: #ff2e63;
      --ol: rgba(255, 0, 64, 0.25);
      --tx: #d6346c;
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial;
      background: radial-gradient(1200px 700px at 70% -10%, var(--bg2), var(--bg1));
      overflow: hidden;
    }
    .w {
      position: relative;
      width: 100%;
      height: 100%;
      display: grid;
      place-items: center;
    }
    canvas {
      width: min(100vw, 900px);
      height: auto;
      aspect-ratio: 1/1;
      max-height: 90vh;
      border-radius: 28px;
      box-shadow: 0 20px 60px rgba(255, 65, 108, 0.25);
      background: linear-gradient(180deg, #fff, #ffe9f1 60%, #ffd6e6);
    }
    .t {
      position: absolute;
      text-align: center;
      pointer-events: none;
      color: var(--tx);
      text-shadow: 0 2px 0 #fff8, 0 8px 30px rgba(214,52,108,0.2);
      width: 100%;
      top: 50%;
      transform: translateY(-10%);
      font-weight: 700;
    }
    .t h1 {
      margin: 0;
      font-size: clamp(28px, 5vw, 56px);
      letter-spacing: .02em;
    }
    .t p {
      margin: .25em 0 0;
      opacity: .7;
      font-size: clamp(12px, 2.4vw, 16px);
    }
    .p {
      position: fixed;
      left: 12px;
      bottom: 12px;
      display: flex;
      gap: 8px;
      padding: 10px 12px;
      background: #ffffffcc;
      border-radius: 14px;
      backdrop-filter: blur(6px);
      box-shadow: 0 10px 30px #0001;
      font-size: 14px;
      align-items: center;
    }
    .p label { opacity: .75; }
    .p input[type="range"] { width: 140px; }
    .b {
      position: fixed; right: 12px; bottom: 12px; opacity: .6; font-size: 12px;
      background: #fff; padding: 6px 10px; border-radius: 12px; box-shadow: 0 8px 24px #0001;
    }
  </style>
</head>
<body>
  <div class="w">
    <canvas id="c" width="1024" height="1024"></canvas>
    <div class="t" id="txt">
      <h1>I Love You</h1>
    </div>
  </div>

  <div class="p">
    <label>Jumlah</label>
    <input id="ct" type="range" min="30" max="300" value="150" />
    <label>Speed</label>
    <input id="sp" type="range" min="1" max="6" value="3" />
  </div>
  <div class="b">Edit teks di kode â†“</div>

  <script>
  ;(() => {
    const cv = document.getElementById('c');
    const ctx = cv.getContext('2d');

    const ui = {
      ct: document.getElementById('ct'),
      sp: document.getElementById('sp'),
    };

    function heartPath(cx, cy, s) {
      ctx.beginPath();
      const st = 360;
      for (let i = 0; i <= st; i++) {
        const t = (Math.PI * 2 * i) / st;
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
        const X = cx + x * s;
        const Y = cy - y * s;
        if (i === 0) ctx.moveTo(X, Y); else ctx.lineTo(X, Y);
      }
      ctx.closePath();
    }

    function smallHeart(x, y, s, c) {
      ctx.save();
      ctx.translate(x, y);
      ctx.scale(s, s);
      ctx.beginPath();
      ctx.moveTo(0, 0);
      ctx.bezierCurveTo(0, -3, -3, -3, -3, 0);
      ctx.bezierCurveTo(-3, 3.5, 0, 5.2, 0, 7);
      ctx.bezierCurveTo(0, 5.2, 3, 3.5, 3, 0);
      ctx.bezierCurveTo(3, -3, 0, -3, 0, 0);
      const g = ctx.createLinearGradient(-3, -3, 3, 7);
      g.addColorStop(0, c);
      g.addColorStop(1, '#fff');
      ctx.fillStyle = g;
      ctx.fill();
      ctx.restore();
    }

    const st = {
      w: cv.width,
      h: cv.height,
      cx: cv.width/2,
      cy: cv.height/2,
      sc: 18,
      ps: [],
      clip: false,
    };

    function rs() {
      const sz = Math.min(window.innerWidth, window.innerHeight * 0.9, 900);
      cv.style.width = sz + 'px';
      cv.style.height = sz + 'px';
      st.w = cv.width;
      st.h = cv.height;
      st.cx = st.w/2; st.cy = st.h/2;
      st.sc = st.w * 0.028;
      mkClip();
      scatter(+ui.ct.value);
    }

    function mkClip() {
      ctx.save();
      ctx.clearRect(0, 0, st.w, st.h);
      heartPath(st.cx, st.cy, st.sc);
      st.hp = new Path2D();
      const p = st.hp;
      const stp = 360;
      for (let i = 0; i <= stp; i++) {
        const t = (Math.PI * 2 * i) / stp;
        const x = 16 * Math.pow(Math.sin(t), 3);
        const y = 13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t);
        const X = st.cx + x * st.sc;
        const Y = st.cy - y * st.sc;
        if (i === 0) p.moveTo(X, Y); else p.lineTo(X, Y);
      }
      p.closePath();
      ctx.restore();
      st.clip = true;
    }

    function rndIn() {
      let x, y; let tr = 0;
      do {
        const r = st.sc * 18;
        x = st.cx + (Math.random()*2 - 1) * r * 0.95;
        y = st.cy + (Math.random()*2 - 1) * r * 0.95;
        tr++;
        if (tr > 2000) break;
      } while (!ctx.isPointInPath(st.hp, x, y));
      return {x, y};
    }

    function scatter(n) {
      const cs = [getComputedStyle(document.documentElement).getPropertyValue('--h1').trim(),
                  getComputedStyle(document.documentElement).getPropertyValue('--h2').trim(),
                  getComputedStyle(document.documentElement).getPropertyValue('--h3').trim()];
      st.ps = Array.from({length: n}, () => {
        const {x, y} = rndIn();
        return {
          x, y,
          vx: (Math.random()*2 - 1) * 0.6,
          vy: (Math.random()*2 - 1) * 0.6,
          sz: 6 + Math.random()*10,
          c: cs[Math.floor(Math.random()*cs.length)],
        };
      });
    }

    function bgHeart() {
      ctx.save();
      heartPath(st.cx, st.cy, st.sc);
      const g = ctx.createRadialGradient(st.cx, st.cy - st.sc*6, st.sc*1.2, st.cx, st.cy, st.sc*16);
      g.addColorStop(0, '#fff');
      g.addColorStop(1, '#ffd4e4');
      ctx.fillStyle = g;
      ctx.fill();
      ctx.lineWidth = 10;
      ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--ol').trim();
      ctx.stroke();
      ctx.restore();
    }

    function tick() {
      ctx.clearRect(0, 0, st.w, st.h);
      bgHeart();
      if (!st.clip) return requestAnimationFrame(tick);
      ctx.save();
      ctx.clip(st.hp);
      const spd = +ui.sp.value * 0.4;
      for (const p of st.ps) {
        p.x += p.vx * spd;
        p.y += p.vy * spd;
        if (!ctx.isPointInPath(st.hp, p.x, p.y)) {
          p.vx *= -1;
          p.vy *= -1;
          p.x += p.vx * 2;
          p.y += p.vy * 2;
        }
        smallHeart(p.x, p.y, p.sz/12, p.c);
      }
      ctx.restore();
      requestAnimationFrame(tick);
    }

    ui.ct.addEventListener('input', () => scatter(+ui.ct.value));
    ui.sp.addEventListener('input', () => {});

    rs();
    window.addEventListener('resize', rs);
    requestAnimationFrame(tick);
  })();
  </script>
</body>
</html>
